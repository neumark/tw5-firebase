
<!doctype html>
<html>
<head>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <style>
    img {
        display: block;
        margin-left: auto;
        margin-right: auto;
        max-width: 80%;
    }
    </style>
</head>
<body>
    <section class="tc-story-river">
        
        <p><div class="tc-tiddler-frame tc-tiddler-view-frame tc-tiddler-exists   tc-tagged-TW5-firebase-docs " data-tags="TW5-firebase-docs" data-tiddler-title="authentication_and_permissions"><div class="tc-tiddler-body tc-reveal"><p>In the <a class="tc-tiddlylink tc-tiddlylink-resolves" href="./first_deploy.html">previous step</a>, the wiki was deployed, but we could not yet log in.</p><h2 class="">Enabling firebase auth providers</h2><p>Firebase supports a wide range of authentication options. We'll turn on two of these: <em>email &amp; password</em> and <em>Google single sign-on (SSO)</em>.</p><p>In the Firebase admin, click on <strong>Authentication</strong> under <em>Build</em>.</p><p><img src="https://raw.githubusercontent.com/neumark/tw5-firebase/master/static/img/doc/fb_auth_initial.png"></p><p>Click on <strong>Get started</strong>. A list of authentication providers should appear. Clicking on the pencil icon near the right side of each item will trigger a dialog which enables the given mechanism.</p><p><img src="https://raw.githubusercontent.com/neumark/tw5-firebase/master/static/img/doc/fb_auth_providers.png"></p><h3 class="">Email/Password</h3><p>Enable the provider, but don't enable email-based passwordless logins.</p><h3 class="">Google</h3><p>Set project support email. The optional configuration options below can be skipped.</p><p><img src="https://raw.githubusercontent.com/neumark/tw5-firebase/master/static/img/doc/fb_auth_google.png"></p><p>With that, the authentication providers are ready. In the list of providers, Email and Google should have <em>Enabled</em> as their status:</p><p><img src="https://raw.githubusercontent.com/neumark/tw5-firebase/master/static/img/doc/fb_auth_ready.png"></p><p>It's time to sign into our wiki for the first time!</p><h2 class="">Providing admin permissions on the wiki</h2><p>After signing in with our Google account, we should see something like this:</p><p><img src="https://raw.githubusercontent.com/neumark/tw5-firebase/master/static/img/doc/tw_no_read_rights.png"></p><p>That is, we get an HTTP permission denied error (403) for a request to <code>recipes/default/tiddlers/</code>.</p><p>Anyone can sign into a firebase web app with their Google account once this auth provider is enabled in firebase. Authentication is now complete, but the freshly signed in user must be authorized to access the wiki.</p><p>The body of the failed HTTP request provides more information: <code>no read access granted to neumark.peter@gmail.com with role 1 on wiki testwiki recipe default</code>. How does the API know which users have access? Access to tiddlers is tied to roles, which are stored in a tiddler. Run:</p><pre><code>./scripts/role.sh grant --email foo@bar.com --role admin</code></pre><p>Where <code>foo@bar.com</code> is replaced with the email address associated with your Google account. Now you should be able to log in!</p><p>Enjoy your wiki!</p></div>

</div>

</p>
        
    </section>
</body>
</html>

